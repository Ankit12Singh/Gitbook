---
description: >-
  This is the final project in DSO_530 Applied Modern Statistical Learning
  Methods class by professor Robertas Gabrys, USC. I completed this project with
  some classmates
---

# Decision Tree Ensembles in R

![Cover](../resources/DT01/images/cover.jpg)

\_This image may not relate to this project at all. Source: www.childcarseats.com.au. All images, data and R Script can be found [here](https://github.com/vuduong191/Gitbook/tree/master/resources/DT01)

Decision Tree has been around for a long time and also known to suffer from bias and variance. Ensemble methods, which combines several trees, are among the most popular solutions. We will try various methods such as bagging, random forest, and boosting in this example.

## Prompt

You are hired to help a finance company identify profitable customers. Its clients are small businesses that purchase financial services. These services include accounting, banking, payroll, and taxes. The finance company also occasionally provides short-term loans to clients. You are also asked to estimate the value of fees generated by potential clients. Clients sign an annual contract, and the finance company would like to be able to predict the total fees that will accumulate over the coming year. It currently relies on search firms, called originators that recruit clients. The finance company would like to identify clients that will generate greater fees so that it can encourage originators to target them.

## Understanding the data
The data set consists of 3272 obs. of  57 variables.There’s a mix of categorical variables and numeric variables.

**Categorical variables:**
We identify some categorical variables with many categories, which may cause difficulties in the modeling process:
- SIC.Code: The numbers in this variable do not represent numeric values but the industry code
- Industry.Category: 32 categories
- Industry.Subcategory: 268 categories
- Metropolitan.Statistical.Area: 232 categories
- TimeZone: 6 levels
- Division: 9 levels
Other categorical variables with not so many categories may bear useful information for the model:
- Originator: 3 categories
- Property.Ownership: 3 categories
- Industry.Category: 4 main categories
- Ever.Bankrupt: 2 categories
- Region: 4 categories
**Ambiguous variables:**
Variables with ambiguous meaning (without explanation from the project file):
- Amt.Past.Judgments
- X1.Years
**Variables with NA values:**
We also recognize NA values in some variables by using str() method in R. Some NA values can be explained and have their own meaning, but some we assume are errors.
- Time.Since.Bankruptcy: For clients that haven’t declared bankruptcy, their value in this variable are NA.
- Past.Due.of.Charge.Offs: For clients that haven’t gone through Charge Off, their value in this variable are NA.
- Credit.Bal.of.Charge.Offs: For clients that haven’t gone through Charge Off, their value in this variable are NA.
- Active.Percent.Revolving: There are 28 observations that have NA value in this variables. After looking at the descriptive statistic of this set of data, we don’t recognize any abnormal behaviors. We assume these are missing values and will remove this in the data preparation step

## Data Preparation
Like most other projects, cleaning and preparing data is an important and time-consuming task. We follow the steps below, detailed codes are available in r-script file.
1.	Converting the data type of monetary value variables from string to number. When we import the original data into R, the money symbol ($) cause these values to be strings, so we need to modify these string values by removing the money symbol and coerce the results to numeric data type.
2.	Removing categorical variables with too many categories.
3.	Modifying the Industry Category variables to have only 4 categories, which are retailing, service, manufacture and wholesales. We also remove all clients in wholesales and manufacture industry. This set includes only 35 observations, so by removing it, we improve the quality of our model.
4.	Adding dummy variables representing categorical variables with small number of categories
5.	Removing three variables with NA values - Time.Since.Bankruptcy, Past.Due.of.Charge.Offs and Credit.Bal.of.Charge.Offs.
6.	Removing 28 observations with NA values in Active.Percent.Revolving variables.
7.	Removing outliers/observations with extreme values.

After these steps, we're left with 3153 observations of 48 variables.

