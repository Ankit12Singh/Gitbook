---
description: >-
  This is a project I did in  DSO_530: Applied Modern Statistical Learning
  Methods class by professor Robertas Gabrys, USC
---

# Multiple Linear Regression with R

## Multiple Linear Regression with R

![Cover](../resources/LM01/images/cover.jpeg)
*This image may not related to this project at all. Source: endpoints.elysiumhealth.com*
### Prompt

Dr. Sam Parameter, author of the textbook Statistics for Poets, has been contemplating starting a new magazine, Popular Statistics, and needs to know if it will be profitable enough. You have augmented the original dataset of 50 magazines by measuring more characteristics of the magazines and their predictors that may be useful in understanding the one-page advertisement costs better. The variables are the following :

```text
Magazine Name
Cost of a four-color, one-page ad
Circulation  (projected, in thousands)
Percent male among the predicted readership
Median household income of readership
Market = Sold in USA or outside USA
```

Your goal is to analyze the data with R using Multiple Linear Regression methods and choose the best model to explain the differences in advertising costs between the different titles and then to predict what Sam should be able to charge for the advertisements in the new magazine.

### Steps

#### Data Preparation

```r
> mag_data <- read.csv("MagazineAds.csv")
> #Import data 
> sum(is.na(mag_data))
> #Check missing values
> head(mag_data)

                    C1.T pagecost  circ percmale medianincome   Market
1                Audubon    25315  1645     51.1        38787 Domestic
2 Better Homes & Gardens   198000 34797     22.1        41933 Domestic
3          Business Week   103300  4760     68.1        63667 Domestic
4           Cosmopolitan    94100 15452     17.3        44237 Domestic
5                   Elle    55540  3735     12.5        47211 Domestic
6           Entrepreneur    40355  2476     60.4        47579 Domestic
```
We need to transform market variable into a dummy varible
```r
> mag_data$domestic <- as.numeric(as.numeric(mag_data$Market)==1)
> #create a new dummy variable (domestic) to describe Market variable
> mag_data1 <- mag_data[,c(-1,-6)]
> #remove the  magazine name and the market columns
```

#### Data Exploration

**Histogram**
```r
> for (i in 1:5){
    histi <- hist(mag_data1[,i], plot=FALSE)
    histi$density <-histi$counts/sum(histi$counts)*100
    plot(histi, freq = FALSE,main = paste("Histogram of" , colnames(mag_data1)[i]), xlab = colnames(mag_data1)[i])
  }
> #a loop that generates five histogram for 5 variables
```

![Histogram of medianincome variable](https://lh3.googleusercontent.com/CakMao_KJJ32dfbRp7aSN6sE6VcAFS_X_wVAWpGs_7qFYHVR5pmspgCYuIOeYAU17WppkAemjvEatSnbk24ncwAFMGPZuaZpo9xoWlD1c_meT6mt9pWmfcEvtMcZ0DuICD0Ps6vGzQ=w400) ![Histogram of domestic variable](https://lh3.googleusercontent.com/tJ9MSkd6er_m_kSsO4ElxEA2JcKmbofilIR4VHbbk60fXx35caAvh15ZKY6b3Xn2qme3LXb-5zS_hHTS3xky44xgw4V-tWzfXMKMuxvZaMSpVqi3XmZa3vR20Kmnsb6VWU01E9VHPg=w400) ![Histogram of percmale variable](https://lh3.googleusercontent.com/o70WkZH5qp1TlL_fsz9wISKJ6AWGb2uVb594t-FageKHmI8jHjv5X9p4x_ody2bJsWB0CEJJlnI8CrBU73joOnBSMkfwuNjOURCwmNynEFLMtHCPqfA4PgW-r2ofbsR7ySw9WERFBA=w400) ![Histogram of domestic circ](https://lh3.googleusercontent.com/jozAM4GOzuJsTklr_HnM9HZe7Ovia_b3Vor4qNE7RtYMilKJRE0-HnnxTqSyEEYijCY73MuG5GgG7_56QLq4hbWk0kqAEZtvP9bY7Mio3l1bsJsEDxZyn2N6H1QhZOe5i9ttAOEXpQ=w400) ![Histogram of domestic pagecost](https://lh3.googleusercontent.com/VXkv0edyx_swalzFNEXkqo0mksUvOoFmaiomLD26RAh32ZmxWVkQqXIebnQCv9VJ8uhj-9f54y0E6ZVZxR2RwqDkOYrnD74eLzn6mraj1iII3LUUaSRYG8KXdw77sPtNZElMysjr1A=w400)

The skewness is noticeable in three variables Median Income, One Ad Page Cost, and Circulation. Theyâ€™re skewed right, with long tail and the peak of the histogram veers to the left. There seems to be more magazines with one ad page cost lower than the average of one ad page cost for all magazines. Same seems to be true for median income and circulation. There are more magazines with lower circulations and lower median income of reader.

```r
> summary(mag_data1)
> #get the descriptive statistics for the variables
    pagecost           circ          percmale      medianincome      domestic     
 Min.   : 20180   Min.   : 1645   Min.   : 3.60   Min.   :31835   Min.   :0.0000  
 1st Qu.: 48875   1st Qu.: 3634   1st Qu.:15.70   1st Qu.:41413   1st Qu.:0.0000  
 Median : 71968   Median : 5510   Median :47.40   Median :46251   Median :1.0000  
 Mean   : 82386   Mean   :10793   Mean   :42.88   Mean   :48958   Mean   :0.7045  
 3rd Qu.: 99895   3rd Qu.:14528   3rd Qu.:65.55   3rd Qu.:58038   3rd Qu.:1.0000  
 Max.   :198000   Max.   :51925   Max.   :88.50   Max.   :72493   Max.   :1.0000  
```
##### Some insights from discriptive statistics for varibles
-	Cost for one ad page varies mostly from $50,000 to $100,000
-	Projected circulation varies mostly from 3500 to 15000, but over 50% of the observations have a circulation of fewer than 6000
-	Over 50% of magazines in the sample targets readers with median income from $40,000 to $60,000
-	There are a significant number of magazines that target solely one reader gender(25% of the observations have a percentage of male reader of less than 15%; 25% of the observations have a percentage of male reader of more than 65%)
-	70% of the observations are domestic magazine

**Correlation Matrix**
```r
> plot(mag_data1)
> #scatter plot
```
![Scatter Plot](https://lh3.googleusercontent.com/wFodBCQEQIjSbkFNODZxOE0PrmnhXI_35W8F1_UMLGeXwiQAEJ5JMPR4Y-BE688eGnlREcYgPNts_qmTJHR4_GCC252CJLkGl84bkOqVfgFA_Wld0qczgMBhWFNIChjPLhufy5TBUQ=w1600)

```r
> round(cor(mag_data1),2)
> #correlation table with 2 decimal rounding
             pagecost  circ percmale medianincome domestic
pagecost         1.00  0.89    -0.15        -0.27     0.20
circ             0.89  1.00    -0.23        -0.44     0.21
percmale        -0.15 -0.23     1.00         0.55     0.17
medianincome    -0.27 -0.44     0.55         1.00     0.06
domestic         0.20  0.21     0.17         0.06     1.00
```